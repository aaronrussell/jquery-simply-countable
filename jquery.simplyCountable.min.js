(function(f){f.fn.simplyCountable=function(a){var a=f.extend({counter:"#counter",countType:"characters",wordSeparator:" ",maxCount:140,strictMax:!1,countDirection:"down",safeClass:"safe",overClass:"over",thousandSeparator:",",onOverCount:function(){},onSafeCount:function(){},onMaxCount:function(){}},a),c=this,b=f(a.counter);if(!b.length)return!1;regex=RegExp("["+a.wordSeparator+"]+");var e=function(){var d,e,g=function(){return"up"===a.countDirection?e:d};"words"===a.countType?(d=a.maxCount-f.trim(c.val()).split(regex).length,
""===c.val()&&(d+=1)):d=a.maxCount-c.val().length;e=d-2*d+a.maxCount;if(a.strictMax&&0>=d){var h=c.val();if(0>d||h.match(RegExp("["+a.wordSeparator+"]$")))a.onMaxCount(g(),c,b);"words"===a.countType?c.val(h.split(regex).slice(0,a.maxCount).join(a.wordSeparator)):c.val(h.substring(0,a.maxCount));d=0;e=a.maxCount}b.text(function(b){var d="";if(a.thousandSeparator){b=b.toString();if(b.match(/^-/)){b=b.substr(1);d="-"}for(var c=b.length-3;c>0;c=c-3)b=b.substr(0,c)+a.thousandSeparator+b.substr(c)}return d+
b}(g()));!b.hasClass(a.safeClass)&&!b.hasClass(a.overClass)?0>d?b.addClass(a.overClass):b.addClass(a.safeClass):0>d&&b.hasClass(a.safeClass)?(b.removeClass(a.safeClass).addClass(a.overClass),a.onOverCount(g(),c,b)):0<=d&&b.hasClass(a.overClass)&&(b.removeClass(a.overClass).addClass(a.safeClass),a.onSafeCount(g(),c,b))};e();c.keyup(e);c.bind("paste",function(){setTimeout(e,5)})}})(jQuery);
